import{_ as e,c as l,a as n,b as a,e as i,d as t,w as k,r as p,o as d}from"./app-1dhAU6lT.js";const r={};function g(y,s){const h=p("VPLink");return d(),l("div",null,[s[99]||(s[99]=n(`<p>本文档列举了 GoogleTest 为创建和操作模拟对象提供的功能设施。 使用前需添加 <code>#include &lt;gmock/gmock.h&gt;</code> 头文件。</p><h2 id="macros" tabindex="-1"><a class="header-anchor" href="#macros"><span>宏</span></a></h2><p>GoogleTest 定义了以下宏来辅助操作模拟对象。</p><h3 id="MOCK_METHOD" tabindex="-1"><a class="header-anchor" href="#MOCK_METHOD"><span>MOCK_METHOD</span></a></h3><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">MOCK_METHOD</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">return_type</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> method_name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">args...</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">));</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">MOCK_METHOD</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">return_type</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> method_name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">args...</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">),</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">specs...</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">));</span></span></code></pre></div><p>在模拟类中定义具有参数 <em><code>arg..</code></em> 和返回类型 <em><code>return_type</code></em> 的模拟方法 <em><code>method_name</code></em>。</p><p><code>MOCK_METHOD</code> 的参数与方法的声明结构对应。 可选的第四个参数 <em><code>specs...</code></em> 是以逗号分隔的限定符列表。 接受的限定符包括：</p><table><thead><tr><th>限定符</th><th>含义</th></tr></thead><tbody><tr><td><code>const</code></td><td>将模拟方法声明为 <code>const</code> 方法。当覆盖 <code>const</code> 方法时必须使用。</td></tr><tr><td><code>override</code></td><td>为方法添加 <code>override</code> 标记。在覆盖 <code>virtual</code> 方法时建议使用。</td></tr><tr><td><code>noexcept</code></td><td>为方法添加 <code>noexcept</code> 标记。当覆盖 <code>noexcept</code>方法时必须使用。</td></tr><tr><td><code>Calltype(calltype)</code></td><td>设置方法的调用类型，例如 <code>Calltype(STDMETHODCALLTYPE)</code>。在 Windows 平台有效。</td></tr><tr><td><code>ref(qualifier)</code></td><td>为方法添加引用限定符，例如 <code>ref(&amp;)</code> 或 <code>ref(&amp;&amp;)</code>。当覆盖具有引用限定符的方法时必须使用。</td></tr></tbody></table><p>注意：参数中的逗号如果没有恰当的括号包裹，可能导致 <code>MOCK_METHOD</code> 无法正确解析参数。 参考以下示例：</p><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark has-highlighted vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">class</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> MyMock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> public</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // 以下两行因参数中的逗号无法编译：</span></span>
<span class="line highlighted error"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  MOCK_METHOD</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">std</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">pair</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">bool</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> int</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;,</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> GetPair</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> ());</span></span>
<span class="line highlighted error"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  MOCK_METHOD</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">bool</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> CheckMap</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">std</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">map</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;int</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> double&gt;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> bool</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // 解决方案 1 —— 用括号包裹含逗号的参数：</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  MOCK_METHOD</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">((</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">std</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">pair</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;bool</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> int&gt;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">),</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> GetPair</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> ());</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  MOCK_METHOD</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">bool</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> CheckMap</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> ((</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">std</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">map</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;int</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> double&gt;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">),</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> bool</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // 解决方案 2 —— 使用类型别名：</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">  using</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> BoolAndInt</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> std</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">pair</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">bool</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> int</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  MOCK_METHOD</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">BoolAndInt</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> GetPair</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> ());</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">  using</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> MapIntDouble</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> std</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">map</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">int</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> double</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  MOCK_METHOD</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">bool</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> CheckMap</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">MapIntDouble</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> bool</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">));</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">};</span></span></code></pre></div><p><code>MOCK_METHOD</code> 必须用于模拟类定义的 <code>public:</code> 段，无论被模拟方法在基类中是 <code>public</code>、<code>protected</code> 还是 <code>private</code>。</p><h3 id="EXPECT_CALL" tabindex="-1"><a class="header-anchor" href="#EXPECT_CALL"><span>EXPECT_CALL</span></a></h3><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">mock_object</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> method_name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">matchers...</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span></span></code></pre></div>`,13)),a("p",null,[s[1]||(s[1]=i("创建",-1)),t(h,{href:"../gmock_for_dummies.md#setting-expectations"},{default:k(()=>s[0]||(s[0]=[i("期望",-1)])),_:1,__:[0]}),s[2]||(s[2]=i("， 表示对象 ",-1)),s[3]||(s[3]=a("em",null,[a("code",null,"mock_object")],-1)),s[4]||(s[4]=i(" 的方法 ",-1)),s[5]||(s[5]=a("em",null,[a("code",null,"method_name")],-1)),s[6]||(s[6]=i(" 将以匹配给定匹配器 ",-1)),s[7]||(s[7]=a("em",null,[a("code",null,"matchers...")],-1)),s[8]||(s[8]=i(" 的参数被调用。 必须在执行模拟对象的任何代码之前设置。",-1))]),a("p",null,[s[12]||(s[12]=i("参数 ",-1)),s[13]||(s[13]=a("em",null,[a("code",null,"matcher...")],-1)),s[14]||(s[14]=i(" 是与方法 ",-1)),s[15]||(s[15]=a("em",null,[a("code",null,"method_name")],-1)),s[16]||(s[16]=i(" 各参数对应的",-1)),t(h,{href:"../gmock_for_dummies.md#matchers-what-arguments-do-we-expect"},{default:k(()=>s[9]||(s[9]=[i("匹配器",-1)])),_:1,__:[9]}),s[17]||(s[17]=i("构成的逗号分隔列表。 该期望仅适用于参数与匹配器完全匹配的方法调用。 若省略 ",-1)),s[18]||(s[18]=a("code",null,"(matcher...)",-1)),s[19]||(s[19]=i("，则默认为每个参数使用",-1)),t(h,{href:"matchers.md#wildcard"},{default:k(()=>s[10]||(s[10]=[i("通配符匹配器 ",-1),a("code",null,"_",-1)])),_:1,__:[10]}),s[20]||(s[20]=i("。 要获取所有内置匹配器列表，请参阅",-1)),t(h,{href:"matchers.md"},{default:k(()=>s[11]||(s[11]=[i("匹配器参考",-1)])),_:1,__:[11]}),s[21]||(s[21]=i("。",-1))]),s[100]||(s[100]=n(`<p>期望后可添加链式调用子句以修饰期望，它们必须按如下顺序使用：</p><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">mock_object</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> method_name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">matchers...</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">With</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">multi_argument_matcher</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // 最多使用一次</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Times</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">cardinality</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">            // 最多使用一次</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">InSequence</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">sequences...</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">      // Can be used any number of times</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">After</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">expectations...</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // Can be used any number of times</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">WillOnce</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">action</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">              // Can be used any number of times</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">WillRepeatedly</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">action</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // Can be used at most once</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">RetiresOnSaturation</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // Can be used at most once</span></span></code></pre></div><p>各修饰子句的详细信息见下文。</p><h4 id="EXPECT_CALL.With" tabindex="-1"><a class="header-anchor" href="#EXPECT_CALL.With"><span>With</span></a></h4><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">With</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">multi_argument_matcher</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre></div><p>限制期望仅应用于参数整体与多参数匹配器 <em><code>multi_argument_matcher</code></em> 匹配的模拟函数调用。</p><p>GoogleTest 会将所有参数作为元组传递给匹配器。 参数 <em><code>multi_argument_matcher</code></em> 的类型必须是 <code>Matcher&lt;std::tuple&lt;A1, ..., An&gt;&gt;</code>，其中 <code>A1, ..., An</code> 是函数的参数类型。</p><p>例如，下列代码设置了当 <code>my_mock.SetPosition()</code> 的两个参数中第一个小于第二个时触发的期望：</p><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">using</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">_</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">using</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Lt</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> SetPosition</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">_</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> _</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">With</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Lt</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">());</span></span></code></pre></div>`,9)),a("p",null,[s[23]||(s[23]=i("GoogleTest 提供了一些内置的二元组匹配器，包括上面的 ",-1)),s[24]||(s[24]=a("code",null,"Lt()",-1)),s[25]||(s[25]=i("。 参见",-1)),t(h,{href:"matchers.md#multi-arg-matchers"},{default:k(()=>s[22]||(s[22]=[i("多参数匹配器",-1)])),_:1,__:[22]}),s[26]||(s[26]=i("。",-1))]),s[101]||(s[101]=n(`<p><code>With</code> 子句在单个期望中最多使用一次，且必须为首个子句。</p><h4 id="EXPECT_CALL.Times" tabindex="-1"><a class="header-anchor" href="#EXPECT_CALL.Times"><span>Times</span></a></h4><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Times</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">cardinality</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre></div><p>指定模拟函数期望被调用的次数。</p><p>参数 <em><code>cardinality</code></em> 表示期望的调用次数，可以是定义在 <code>::testing</code> 命名空间中的以下任一值：</p><table><thead><tr><th>基数</th><th>含义</th></tr></thead><tbody><tr><td><code>AnyNumber()</code></td><td>函数可被调用任意次数。</td></tr><tr><td><code>AtLeast(n)</code></td><td>函数至少被调用 <em>n</em> 次。</td></tr><tr><td><code>AtMost(n)</code></td><td>函数至多被调用 <em>n</em> 次。</td></tr><tr><td><code>Between(m, n)</code></td><td>函数调用次数在 <em>m</em> 到 <em>n</em> 之间（包含边界）。</td></tr><tr><td><code>Exactly(n)</code> 或 <code>n</code></td><td>函数恰好被调用 <em>n</em> 次。<em>n</em> 为 0 时，表示不应被调用。</td></tr></tbody></table><p>若省略 <code>Times</code> 子句，GoogleTest 按以下规则推断调用次数：</p><ul><li>若 <a href="#EXPECT_CALL.WillOnce"><code>WillOnce()</code></a> 和 <a href="#EXPECT_CALL.WillRepeatedly"><code>WillRepeatedly()</code></a> 都未给定，推断为 <code>Times(1)</code>。</li><li>若存在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy="false">(</mo><mo>≥</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n (\\ge 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 个 <code>WillOnce()</code>，但不存在 <code>WillRepeatedly()</code>，推断为 <code>Times(n)</code>。</li><li>若存在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy="false">(</mo><mo>≥</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n (\\ge 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span> 个 <code>WillOnce()</code> 和一个 <code>WillRepeatedly()</code>，推断为 <code>Times(AtLeast(n))</code>。</li></ul><p><code>Times</code> 子句在单个期望中最多使用一次。</p><h4 id="EXPECT_CALL.InSequence" tabindex="-1"><a class="header-anchor" href="#EXPECT_CALL.InSequence"><span>InSequence</span></a></h4><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">InSequence</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">sequences...</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre></div><p>指定模拟函数调用应在特定序列中发生。</p><p>参数 <em><code>sequence...</code></em> 是任意数量的 <a href="#Sequence"><code>Sequence</code></a> 对象。 被分配到同一序列的期望必须按声明顺序发生。</p><p>例如，下列代码设置了 <code>my_mock</code> 的 <code>Reset()</code> 方法必须在 <code>GetSize()</code> 和 <code>Describe()</code> 之前调用， 而 <code>GetSize()</code> 和 <code>Describe()</code> 可按任意顺序调用的期望：</p><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">using</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Sequence</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Sequence s1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> s2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> Reset</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">())</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">InSequence</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">s1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> s2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> GetSize</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">())</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">InSequence</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">s1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> Describe</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">())</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">InSequence</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">s2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span></code></pre></div><p><code>InSequence</code> 子句可在单个期望中多次使用。</p><p>另见 <a href="#InSequence"><code>InSequence</code> 类</a>。</p><h4 id="EXPECT_CALL.After" tabindex="-1"><a class="header-anchor" href="#EXPECT_CALL.After"><span>After</span></a></h4><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">After</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">expectations...</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre></div><p>指定模拟函数调用应在其他调用之后发生。</p><p>参数 <em><code>expectation...</code></em> 可以是至多五个 <a href="#Expectation"><code>Expectation</code></a> 或 <a href="#ExpectationSet"><code>ExpectationSet</code></a> 对象。 当前期望必须在所有指定期望之后发生。</p><p>例如，下列代码设置了 <code>my_mock</code> 的 <code>Describe()</code> 方法必须在 <code>InitX()</code> 和 <code>InitY()</code> 之后调用的期望：</p><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">using</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Expectation</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">...</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Expectation init_x </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> InitX</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">());</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Expectation init_y </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> InitY</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">());</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> Describe</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">())</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">After</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">init_x</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> init_y</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span></code></pre></div><p>当期望的前置条件数量较大或动态变化时，可以使用 <code>ExpectationSet</code>：</p><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">using</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ExpectationSet</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">...</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ExpectationSet all_inits</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 收集所有 InitElement() 调用的期望</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">for</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">int</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> i </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> i </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> element_count</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> i</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">++</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  all_inits </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">+=</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> InitElement</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">i</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">));</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> Describe</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">())</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">After</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">all_inits</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // 期望 Describe() 在所有 InitElement() 之后调用</span></span></code></pre></div><p><code>After</code> 子句可在单个期望中多次使用。</p><h4 id="EXPECT_CALL.WillOnce" tabindex="-1"><a class="header-anchor" href="#EXPECT_CALL.WillOnce"><span>WillOnce</span></a></h4><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">WillOnce</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">action</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre></div><p>为单个匹配函数指定调用时的实际行为。</p>`,29)),a("p",null,[s[29]||(s[29]=i("参数 ",-1)),s[30]||(s[30]=a("em",null,[a("code",null,"action")],-1)),s[31]||(s[31]=i(" 表示函数调用要执行的",-1)),t(h,{href:"../gmock_for_dummies.md#actions-what-should-it-do"},{default:k(()=>s[27]||(s[27]=[i("动作",-1)])),_:1,__:[27]}),s[32]||(s[32]=i("。 要获取所有内置动作，请参阅",-1)),t(h,{href:"actions.md"},{default:k(()=>s[28]||(s[28]=[i("动作参考",-1)])),_:1,__:[28]}),s[33]||(s[33]=i("。",-1))]),s[102]||(s[102]=n(`<p>在未指定 <code>Times</code> 时，使用 <code>WillOnce</code> 会隐式设置调用次数。 参见 <a href="#EXPECT_CALL.Times"><code>Times</code></a>。</p><p>每次匹配调用将按声明顺序执行下一个动作。 例如，下列代码指定 <code>my_mock.GetNumber()</code> 应被调用 3 次，且分别返回 <code>1</code>、<code>2</code> 和 <code>3</code>：</p><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">using</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Return</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> GetNumber</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">())</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">WillOnce</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Return</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">WillOnce</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Return</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">WillOnce</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Return</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">));</span></span></code></pre></div><p><code>WillOnce</code> 子句可在单个期望中多次使用。 与 <code>WillRepeatedly</code> 不同，每个 <code>WillOnce</code> 动作最多执行一次，因此可接受仅移动类型或带有 <code>&amp;&amp;</code> 限定符的动作。</p><h4 id="EXPECT_CALL.WillRepeatedly" tabindex="-1"><a class="header-anchor" href="#EXPECT_CALL.WillRepeatedly"><span>WillRepeatedly</span></a></h4><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">WillRepeatedly</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">action</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre></div><p>为后续所有匹配函数指定调用时的实际行为。 在所有 <code>WillOnce</code> 动作（若存在）执行后生效。</p>`,7)),a("p",null,[s[36]||(s[36]=i("参数 ",-1)),s[37]||(s[37]=a("em",null,[a("code",null,"action")],-1)),s[38]||(s[38]=i(" 表示函数调用要执行的",-1)),t(h,{href:"../gmock_for_dummies.md#actions-what-should-it-do"},{default:k(()=>s[34]||(s[34]=[i("动作",-1)])),_:1,__:[34]}),s[39]||(s[39]=i("。 要获取所有内置动作，请参阅",-1)),t(h,{href:"actions.md"},{default:k(()=>s[35]||(s[35]=[i("动作参考",-1)])),_:1,__:[35]}),s[40]||(s[40]=i("。",-1))]),s[103]||(s[103]=n(`<p>在未指定 <code>Times</code> 时，使用 <code>WillRepeatedly</code> 会隐式设置调用次数。 参见 <a href="#EXPECT_CALL.Times"><code>Times</code></a>。</p><p>若存在 <code>WillOnce</code> 子句，匹配到的调用将先执行这些动作，再执行 <code>WillRepeatedly</code> 指定的动作。 例如：</p><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">using</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Return</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> GetName</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">())</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">WillRepeatedly</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Return</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">John Doe</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">));</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // 所有调用返回 &quot;John Doe&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> GetNumber</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">())</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">WillOnce</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Return</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">42</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 首次调用返回 42</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">WillRepeatedly</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Return</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">7</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">));</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // 后续调用返回 7</span></span></code></pre></div><p><code>WillRepeatedly</code> 子句在单个期望中最多使用一次。</p><h4 id="EXPECT_CALL.RetiresOnSaturation" tabindex="-1"><a class="header-anchor" href="#EXPECT_CALL.RetiresOnSaturation"><span>RetiresOnSaturation</span></a></h4><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">RetiresOnSaturation</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span></span></code></pre></div><p>表示期望在达到预期调用次数后将不再生效。</p><p><code>RetiresOnSaturation</code> 子句仅对调用次数存在上限的期望有效。 期望在<strong>饱和</strong>（<em>saturated</em>，达到上限）后将<strong>退休</strong>（<em>retire</em>，不再匹配任何调用）。 例如：</p><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">using</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">_</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">using</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">AnyNumber</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> SetNumber</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">_</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // 期望 1</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Times</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">AnyNumber</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">());</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> SetNumber</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">7</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // 期望 2</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Times</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">RetiresOnSaturation</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span></code></pre></div><p>这里，前两次 <code>my_mock.SetNumber(7)</code> 调用将匹配期望 2，之后期望 2 失效。 第三次调用将匹配期望 1。 若期望 2 未设置 <code>RetiresOnSaturation()</code>，第三次调用仍会匹配期望 2，导致期望因超出调用上限而失败。</p><p><code>RetiresOnSaturation</code> 子句在单个期望中最多使用一次，且必须为最后一个子句。</p><h3 id="ON_CALL" tabindex="-1"><a class="header-anchor" href="#ON_CALL"><span>ON_CALL</span></a></h3><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ON_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">mock_object</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> method_name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">matchers...</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span></span></code></pre></div><p>定义当对象 <em><code>mock_object</code></em> 的方法 <em><code>method_name</code></em> 将以匹配给定匹配器 <em><code>matchers...</code></em> 的参数被调用时的行为。 需要使用修饰子句来指定具体行为。 <strong>不设置</strong>方法必须被调用的期望。</p>`,14)),a("p",null,[s[44]||(s[44]=i("参数 ",-1)),s[45]||(s[45]=a("em",null,[a("code",null,"matcher...")],-1)),s[46]||(s[46]=i(" 是与方法 ",-1)),s[47]||(s[47]=a("em",null,[a("code",null,"method_name")],-1)),s[48]||(s[48]=i(" 各参数对应的",-1)),t(h,{href:"../gmock_for_dummies.md#matchers-what-arguments-do-we-expect"},{default:k(()=>s[41]||(s[41]=[i("匹配器",-1)])),_:1,__:[41]}),s[49]||(s[49]=i("构成的逗号分隔列表。 该期望仅适用于参数与匹配器完全匹配的方法调用。 若省略 ",-1)),s[50]||(s[50]=a("code",null,"(matcher...)",-1)),s[51]||(s[51]=i("，则默认为每个参数使用",-1)),t(h,{href:"matchers.md#wildcard"},{default:k(()=>s[42]||(s[42]=[i("通配符匹配器 ",-1),a("code",null,"_",-1)])),_:1,__:[42]}),s[52]||(s[52]=i("。 要获取所有内置匹配器列表，请参阅",-1)),t(h,{href:"matchers.md"},{default:k(()=>s[43]||(s[43]=[i("匹配器参考",-1)])),_:1,__:[43]}),s[53]||(s[53]=i("。",-1))]),s[104]||(s[104]=n(`<p>其后可添加链式调用子句以设置方法行为，它们必须按如下顺序使用：</p><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ON_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">mock_object</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> method_name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">matchers...</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">With</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">multi_argument_matcher</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // 最多使用一次</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">WillByDefault</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">action</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 必须使用</span></span></code></pre></div><p>各修饰子句的详细信息见下文。</p><h4 id="ON_CALL.With" tabindex="-1"><a class="header-anchor" href="#ON_CALL.With"><span>With</span></a></h4><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">With</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">multi_argument_matcher</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre></div><p>限制仅应用于参数整体与多参数匹配器 <em><code>multi_argument_matcher</code></em> 匹配的模拟函数调用。</p><p>GoogleTest 会将所有参数作为元组传递给匹配器。 参数 <em><code>multi_argument_matcher</code></em> 的类型必须是 <code>Matcher&lt;std::tuple&lt;A1, ..., An&gt;&gt;</code>，其中 <code>A1, ..., An</code> 是函数的参数类型。</p><p>例如，下列代码设置了当 <code>my_mock.SetPosition()</code> 的两个参数中第一个小于第二个时的行为：</p><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">using</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">_</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">using</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Lt</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">using</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Return</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ON_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> SetPosition</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">_</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> _</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">With</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Lt</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">())</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">WillByDefault</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Return</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">true</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">));</span></span></code></pre></div>`,9)),a("p",null,[s[55]||(s[55]=i("GoogleTest 提供了一些内置的二元组匹配器，包括上面的 ",-1)),s[56]||(s[56]=a("code",null,"Lt()",-1)),s[57]||(s[57]=i("。 参见",-1)),t(h,{href:"matchers.md#multi-arg-matchers"},{default:k(()=>s[54]||(s[54]=[i("多参数匹配器",-1)])),_:1,__:[54]}),s[58]||(s[58]=i("。",-1))]),s[105]||(s[105]=n('<p><code>With</code> 子句在单个 <code>ON_CALL</code> 中最多使用一次。</p><h4 id="ON_CALL.WillByDefault" tabindex="-1"><a class="header-anchor" href="#ON_CALL.WillByDefault"><span>WillByDefault</span></a></h4><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">WillByDefault</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">action</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre></div><p>指定匹配到的模拟函数调用的默认行为。</p>',4)),a("p",null,[s[61]||(s[61]=i("参数 ",-1)),s[62]||(s[62]=a("em",null,[a("code",null,"action")],-1)),s[63]||(s[63]=i(" 表示函数调用要执行的",-1)),t(h,{href:"../gmock_for_dummies.md#actions-what-should-it-do"},{default:k(()=>s[59]||(s[59]=[i("动作",-1)])),_:1,__:[59]}),s[64]||(s[64]=i("。 要获取所有内置动作，请参阅",-1)),t(h,{href:"actions.md"},{default:k(()=>s[60]||(s[60]=[i("动作参考",-1)])),_:1,__:[60]}),s[65]||(s[65]=i("。",-1))]),s[106]||(s[106]=n(`<p>例如，下列代码指定 <code>my_mock.Greet()</code> 默认返回 <code>&quot;hello&quot;</code>：</p><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">using</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Return</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ON_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> Greet</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">())</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">WillByDefault</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Return</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">hello</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">));</span></span></code></pre></div><p><code>WillByDefault</code> 指定的动作会被匹配的 <code>EXPECT_CALL</code> 语句中的动作覆盖。 参见 <a href="#EXPECT_CALL.WillOnce"><code>WillOnce</code></a> 和 <a href="#EXPECT_CALL.WillRepeatedly"><code>WillRepeatedly</code></a>。</p><p><code>WillByDefault</code> 子句在单个 <code>ON_CALL</code> 必须且只能使用一次。</p><h2 id="classes" tabindex="-1"><a class="header-anchor" href="#classes"><span>类</span></a></h2><p>GoogleTest 定义了以下类来辅助操作模拟对象。</p><h3 id="DefaultValue" tabindex="-1"><a class="header-anchor" href="#DefaultValue"><span>DefaultValue</span></a></h3><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">DefaultValue</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">T</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span></span></code></pre></div><p>允许用户为可复制且具有公有析构函数的类型 <code>T</code> 指定默认值。 对于返回类型为 <code>T</code> 的模拟函数，当未指定任何动作时，将返回此默认值。</p><p>提供了静态方法 <code>Set()</code>、<code>SetFactory</code> 和 <code>Clear()</code> 来管理默认值：</p><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 设置要返回的默认值；T 必须可复制构造</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">DefaultValue</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">T</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Set</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">value</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 设置工厂函数；按需调用；T 必须可移动构造</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">T</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> MakeT</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">DefaultValue</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">T</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">SetFactory</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&amp;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">MakeT</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 清除设置的默认值</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">DefaultValue</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">T</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Clear</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span></code></pre></div><h3 id="NiceMock" tabindex="-1"><a class="header-anchor" href="#NiceMock"><span>NiceMock</span></a></h3><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">NiceMock</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">T</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span></span></code></pre></div>`,13)),a("p",null,[s[67]||(s[67]=i("表示抑制了",-1)),t(h,{href:"../gmock_cook_book.md#uninteresting-vs-unexpected"},{default:k(()=>s[66]||(s[66]=[i("无趣调用",-1)])),_:1,__:[66]}),s[68]||(s[68]=i("警告的模拟对象。 模板参数 ",-1)),s[69]||(s[69]=a("code",null,"T",-1)),s[70]||(s[70]=i(" 可以是任意模拟类（已经被 ",-1)),s[71]||(s[71]=a("code",null,"NiceMock",-1)),s[72]||(s[72]=i("、",-1)),s[73]||(s[73]=a("code",null,"NaggyMock",-1)),s[74]||(s[74]=i(" 或 ",-1)),s[75]||(s[75]=a("code",null,"StrictMock",-1)),s[76]||(s[76]=i(" 修饰的除外）。",-1))]),s[107]||(s[107]=n(`<p><code>NiceMock&lt;T&gt;</code> 的用法与 <code>T</code> 类似。 作为 <code>T</code> 的子类，<code>NiceMock&lt;T&gt;</code> 可用于任何接受 <code>T</code> 类型对象的场景。 此外，<code>NiceMock&lt;T&gt;</code> 还可使用任意 <code>T</code> 的构造函数。</p><p>例如，下列代码抑制了 <code>MockClass</code> 类型模拟对象 <code>my_mock</code> 在调用 <code>DoSomething()</code> 之外的方法时的警告：</p><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">using</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">NiceMock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">...</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">NiceMock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">MockClass</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">some</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">args</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> DoSomething</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">());</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// ... 使用 my_mock 的代码 ...</span></span></code></pre></div><p><code>NiceMock&lt;T&gt;</code> 仅对直接在 <code>T</code> 类中使用 <code>MOCK_METHOD</code> 宏定义的模拟方法有效。 若模拟方法定义于基类，仍可能产生警告。</p><p>若 <code>T</code> 的析构函数不是虚函数，<code>NiceMock&lt;T&gt;</code> 可能无法正常工作。</p><h3 id="NaggyMock" tabindex="-1"><a class="header-anchor" href="#NaggyMock"><span>NaggyMock</span></a></h3><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">NaggyMock</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">T</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span></span></code></pre></div>`,7)),a("p",null,[s[78]||(s[78]=i("表示会生成",-1)),t(h,{href:"../gmock_cook_book.md#uninteresting-vs-unexpected"},{default:k(()=>s[77]||(s[77]=[i("无趣调用",-1)])),_:1,__:[77]}),s[79]||(s[79]=i("警告的模拟对象。 模板参数 ",-1)),s[80]||(s[80]=a("code",null,"T",-1)),s[81]||(s[81]=i(" 可以是任意模拟类（已经被 ",-1)),s[82]||(s[82]=a("code",null,"NiceMock",-1)),s[83]||(s[83]=i("、",-1)),s[84]||(s[84]=a("code",null,"NaggyMock",-1)),s[85]||(s[85]=i(" 或 ",-1)),s[86]||(s[86]=a("code",null,"StrictMock",-1)),s[87]||(s[87]=i(" 修饰的除外）。",-1))]),s[108]||(s[108]=n(`<p><code>NaggyMock&lt;T&gt;</code> 的用法与 <code>T</code> 类似。 作为 <code>T</code> 的子类，<code>NaggyMock&lt;T&gt;</code> 可用于任何接受 <code>T</code> 类型对象的场景。 此外，<code>NaggyMock&lt;T&gt;</code> 还可使用任意 <code>T</code> 的构造函数。</p><p>例如，下列代码在 <code>MockClass</code> 类型模拟对象 <code>my_mock</code> 调用 <code>DoSomething()</code> 之外的方法时会产生警告：</p><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">using</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">NiceMock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">...</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">NaggyMock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">MockClass</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">some</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">args</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> DoSomething</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">());</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// ... 使用 my_mock 的代码 ...</span></span></code></pre></div><p>默认情况下，<code>T</code> 类型的模拟对象与 <code>NaggyMock&lt;T&gt;</code> 行为相同。</p><h3 id="StrictMock" tabindex="-1"><a class="header-anchor" href="#StrictMock"><span>StrictMock</span></a></h3><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">StrictMock</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">T</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span></span></code></pre></div>`,6)),a("p",null,[s[89]||(s[89]=i("表示会将",-1)),t(h,{href:"../gmock_cook_book.md#uninteresting-vs-unexpected"},{default:k(()=>s[88]||(s[88]=[i("无趣调用",-1)])),_:1,__:[88]}),s[90]||(s[90]=i("视为错误的模拟对象。 模板参数 ",-1)),s[91]||(s[91]=a("code",null,"T",-1)),s[92]||(s[92]=i(" 可以是任意模拟类（已经被 ",-1)),s[93]||(s[93]=a("code",null,"NiceMock",-1)),s[94]||(s[94]=i("、",-1)),s[95]||(s[95]=a("code",null,"NaggyMock",-1)),s[96]||(s[96]=i(" 或 ",-1)),s[97]||(s[97]=a("code",null,"StrictMock",-1)),s[98]||(s[98]=i(" 修饰的除外）。",-1))]),s[109]||(s[109]=n(`<p><code>StrictMock&lt;T&gt;</code> 的用法与 <code>T</code> 类似。 作为 <code>T</code> 的子类，<code>StrictMock&lt;T&gt;</code> 可用于任何接受 <code>T</code> 类型对象的场景。 此外，<code>StrictMock&lt;T&gt;</code> 还可使用任意 <code>T</code> 的构造函数。</p><p>例如，下列代码在 <code>MockClass</code> 类型模拟对象 <code>my_mock</code> 调用 <code>DoSomething()</code> 之外的方法时会触发错误：</p><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">using</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">NiceMock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">...</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">StrictMock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">MockClass</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">some</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">args</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">my_mock</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> DoSomething</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">());</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// ... 使用 my_mock 的代码 ...</span></span></code></pre></div><p><code>StrictMock&lt;T&gt;</code> 仅对直接在 <code>T</code> 类中使用 <code>MOCK_METHOD</code> 宏定义的模拟方法有效。 若模拟方法定义于基类，仍可能产生警告。</p><p>若 <code>T</code> 的析构函数不是虚函数，<code>StrictMock&lt;T&gt;</code> 可能无法正常工作。</p><h3 id="Sequence" tabindex="-1"><a class="header-anchor" href="#Sequence"><span>Sequence</span></a></h3><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Sequence</span></span></code></pre></div><p>表示期望的时序序列。 详细用法请参阅 <code>EXPECT_CALL</code> 的 <a href="#EXPECT_CALL.InSequence"><code>InSequence</code></a> 子句。</p><h3 id="InSequence" tabindex="-1"><a class="header-anchor" href="#InSequence"><span>InSequence</span></a></h3><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">InSequence</span></span></code></pre></div><p>该类型的对象会将其作用域内所有期望添加至一个匿名序列。</p><p>这便于表达多个按声明顺序执行的期望：</p><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">using</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">InSequence</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  InSequence seq</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // 以下期望按声明顺序执行</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">...</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">...</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  ...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">...</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div><p><code>InSequence</code> 对象的名称无关紧要。</p><h3 id="Expectation" tabindex="-1"><a class="header-anchor" href="#Expectation"><span>Expectation</span></a></h3><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Expectation</span></span></code></pre></div><p>表示由 <a href="#EXPECT_CALL"><code>EXPECT_CALL</code></a> 创建的模拟函数调用期望：</p><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">using</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Expectation</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Expectation my_expectation </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">...</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span></code></pre></div><p>用于指定期望序列，参见 <code>EXPECT_CALL</code> 的 <a href="#EXPECT_CALL.After"><code>After</code></a> 子句。</p><h3 id="ExpectationSet" tabindex="-1"><a class="header-anchor" href="#ExpectationSet"><span>ExpectationSet</span></a></h3><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ExpectationSet</span></span></code></pre></div><p>表示模拟函数调用期望的集合。</p><p>使用 <code>+=</code> 运算符来添加 <a href="#Expectation"><code>Expectation</code></a> 对象到集合中：</p><div class="language-cpp" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">using</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ::</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">testing</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">::</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ExpectationSet</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ExpectationSet my_expectations</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">my_expectations </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">+=</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> EXPECT_CALL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">...</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span></code></pre></div><p>用于指定期望序列，参见 <code>EXPECT_CALL</code> 的 <a href="#EXPECT_CALL.After"><code>After</code></a> 子句。</p>`,25))])}const A=e(r,[["render",g]]),c=JSON.parse('{"path":"/gtest/reference/mocking/","title":"模拟参考","lang":"zh-CN","frontmatter":{"title":"模拟参考","createTime":"2025-04-05T18:44:26.000Z","permalink":"/gtest/reference/mocking/","copyright":{"creation":"translate","source":"https://google.github.io/googletest/reference/mocking.html"},"outline":[2,4],"description":"本文档列举了 GoogleTest 为创建和操作模拟对象提供的功能设施。 使用前需添加 #include <gmock/gmock.h> 头文件。 宏 GoogleTest 定义了以下宏来辅助操作模拟对象。 MOCK_METHOD 在模拟类中定义具有参数 arg.. 和返回类型 return_type 的模拟方法 method_name。 MOCK_M...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"模拟参考\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-04-22T11:27:50.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://sunirein.tech/gtest/reference/mocking/"}],["meta",{"property":"og:site_name","content":"SuniRein 的个人小站"}],["meta",{"property":"og:title","content":"模拟参考"}],["meta",{"property":"og:description","content":"本文档列举了 GoogleTest 为创建和操作模拟对象提供的功能设施。 使用前需添加 #include <gmock/gmock.h> 头文件。 宏 GoogleTest 定义了以下宏来辅助操作模拟对象。 MOCK_METHOD 在模拟类中定义具有参数 arg.. 和返回类型 return_type 的模拟方法 method_name。 MOCK_M..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-04-22T11:27:50.000Z"}],["meta",{"property":"article:modified_time","content":"2025-04-22T11:27:50.000Z"}]]},"readingTime":{"minutes":11.82,"words":3547},"git":{"createdTime":1743849914000,"updatedTime":1745321270000,"contributors":[{"name":"SuniRein","username":"SuniRein","email":"sunirein@qq.com","commits":5,"avatar":"https://avatars.githubusercontent.com/SuniRein?v=4","url":"https://github.com/SuniRein"}]},"autoDesc":true,"filePathRelative":"notes/GoogleTest/reference/mocking.md","headers":[]}');export{A as comp,c as data};
