import{_ as i,c as a,e,o as n}from"./app-C-DIM9nL.js";const t={};function l(d,s){return n(),a("div",null,[...s[0]||(s[0]=[e(`<p>前不久我的云服务器快到期了，重新买了台新的服务器，但是原来的 Nginx 配置文件比较复杂，迁移起来麻烦，而且证书自动续期也得重新配置。</p><p>在查阅资料时，我发现了 Caddy 这个轻量级的 Web 服务器，配置文件简洁明了，内置自动 HTTPS 功能，非常适合个人和小型项目使用。</p><h2 id="为什么选择-caddy" tabindex="-1"><a class="header-anchor" href="#为什么选择-caddy"><span>为什么选择 Caddy？</span></a></h2><p><a href="https://caddyserver.com/" target="_blank" rel="noopener noreferrer">Caddy</a> 是一款基于 Go 语言编写的强大且可扩展的平台，提供“开箱即用”的使用体验，相比 Ngnix 有以下优势：</p><ul><li><strong>配置文件简洁</strong>：Caddy 的配置文件非常直观，提供了合理的默认值，减少了配置的复杂度。</li><li><strong>自动 HTTPS</strong>：Caddy 内置了 Let&#39;s Encrypt 支持，能够自动获取和续期 SSL 证书，无需额外配置。</li><li><strong>文档易读</strong>：Caddy 官方文档清晰易懂，不像 Nginx 那样零散臃肿。</li></ul><p>尽管 Caddy 可能在性能上不如 Nginx，特别是在高并发场景下，但对于个人网站和小型项目来说，Caddy 已经足够强大。</p><h2 id="使用-caddy" tabindex="-1"><a class="header-anchor" href="#使用-caddy"><span>使用 Caddy</span></a></h2><p>首先，按照<a href="https://caddyserver.com/docs/install" target="_blank" rel="noopener noreferrer">官方文档</a>的指引，安装好 Caddy 并启用。</p><p>在当前目录下，创建名为 <code>Caddyfile</code> 的配置文件，编辑该文件：</p><div class="language-caddy" data-highlighter="shiki" data-ext="caddy" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-caddy"><span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">www.sunirein.tech</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">  redir</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> https://sunirein.tech</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">uri</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">sunirein.tech</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">  root</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> *</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /var/www</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">  file_server</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">  encode</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> gzip</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> zstd</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">ttrss.sunirein.tech</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">  reverse_proxy</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> localhost:1081</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">  encode</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> gzip</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> zstd</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div><p>上面这份配置文件实现了以下功能：</p><ol><li>将 <code>www.sunirein.tech</code> 重定向到 <code>sunirein.tech</code>。</li><li>为 <code>sunirein.tech</code> 提供静态文件服务，文件根目录为 <code>/var/www</code>，并启用 gzip 和 zstd 压缩。</li><li>将 <code>ttrss.sunirein.tech</code> 的请求反向代理到本地的 1081 端口，并启用 gzip 和 zstd 压缩。</li></ol><p>此外，Caddy 会自动为这些域名获取和续期 SSL 证书，自动处理 HTTPS 重定向等问题，无需额外配置，非常省心。</p><p>如果需要为其他域名添加服务，只需在 <code>Caddyfile</code> 中添加相应的块即可。</p><p>之后，使用以下命令加载 Caddy 配置，使其生效：</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">caddy</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> reload</span></span></code></pre></div><h2 id="可选-配置阿里云-dns" tabindex="-1"><a class="header-anchor" href="#可选-配置阿里云-dns"><span>可选：配置阿里云 DNS</span></a></h2><p>Caddy 默认通过 <strong>HTTP 质询</strong>或 <strong>TLS-ALPN 质询</strong>来验证域名所有权，从而自动获取证书。</p><p>但是，由于我配置了 DNS 分流，国外的访问流量会被解析到 Github Page，因此 Let&#39;s Encrypt 无法验证域名所有权。</p><p>这时，可以通过配置 <strong>DNS 质询</strong>来解决这个问题。这里我以阿里云 DNS 为例，其他 DNS 服务商的配置方法类似。</p><div class="hint-container warning"><p class="hint-container-title">注意</p><p>除了上述情况外，如果你需要申请通配符证书（如 <code>*.example.com</code>），也必须使用 DNS 质询。</p></div><div class="vp-steps"><ol><li><p>首先，需要下载对应的 DNS 模块：</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">caddy</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> add-package</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> github.com/caddy-dns/alidns</span></span></code></pre></div></li><li><p>申请阿里云 DNS 访问密钥。</p><p>进入 <a href="https://ram.console.aliyun.com/users" target="_blank" rel="noopener noreferrer">阿里云访问控制台</a>，并创建一个子用户，授予 <code>AliyunDNSFullAccess</code> 权限。</p><p>点击你新创建的子用户，进入用户详情页，为该用户创建一个 <code>AccessKey</code>，并保存好 <code>AccessKey ID</code> 和 <code>AccessKey Secret</code>。</p></li><li><p>在 <code>Caddyfile</code> 中配置 DNS 质询。</p><p>可以在顶部添加全局配置：</p><div class="language-caddy" data-highlighter="shiki" data-ext="caddy" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-caddy"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">  acme_dns</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> alidns</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">    access_key_id</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> YOUR_ACCESS_KEY_ID</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">    access_key_secret</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> YOUR_ACCESS_KEY_SECRET</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div><p>或者在域名块中单独配置：</p><div class="language-caddy" data-highlighter="shiki" data-ext="caddy" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-caddy"><span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">your.domain</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">  tls</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">    dns</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> alidns</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">      access_key_id</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> YOUR_ACCESS_KEY_ID</span></span>
<span class="line"><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;">      access_key_secret</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> YOUR_ACCESS_KEY_SECRET</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div></li><li><p>最后，重新加载 Caddy 配置：</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">caddy</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> reload</span></span></code></pre></div><p>这样，Caddy 就会使用阿里云 DNS 来验证域名所有权，从而成功获取 SSL 证书。</p></li></ol></div><h2 id="参考资料" tabindex="-1"><a class="header-anchor" href="#参考资料"><span>参考资料</span></a></h2><ul><li><a href="https://caddyserver.com/docs/" target="_blank" rel="noopener noreferrer">Caddy 官方文档</a></li><li><a href="https://caddy2.dengxiaolong.com/docs/" target="_blank" rel="noopener noreferrer">Caddy v2 中文文档</a></li><li><a href="https://www.cnblogs.com/turingguo/p/caddy.html" target="_blank" rel="noopener noreferrer">caddy 配置反向代理和 ssl 证书申请 | 博客园 turingguo</a></li></ul>`,24)])])}const p=i(t,[["render",l]]),r=JSON.parse('{"path":"/blog/4iizatfo/","title":"从 Nginx 到 Caddy：配置简化与自动 HTTPS 的魅力","lang":"zh-CN","frontmatter":{"title":"从 Nginx 到 Caddy：配置简化与自动 HTTPS 的魅力","createTime":"2025/10/13 17:20:38","permalink":"/blog/4iizatfo/","tags":["建站","Caddy","Nginx"],"description":"前不久我的云服务器快到期了，重新买了台新的服务器，但是原来的 Nginx 配置文件比较复杂，迁移起来麻烦，而且证书自动续期也得重新配置。 在查阅资料时，我发现了 Caddy 这个轻量级的 Web 服务器，配置文件简洁明了，内置自动 HTTPS 功能，非常适合个人和小型项目使用。 为什么选择 Caddy？ Caddy 是一款基于 Go 语言编写的强大且可...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"从 Nginx 到 Caddy：配置简化与自动 HTTPS 的魅力\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-10-14T00:37:40.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://sunirein.tech/blog/4iizatfo/"}],["meta",{"property":"og:site_name","content":"SuniRein 的个人小站"}],["meta",{"property":"og:title","content":"从 Nginx 到 Caddy：配置简化与自动 HTTPS 的魅力"}],["meta",{"property":"og:description","content":"前不久我的云服务器快到期了，重新买了台新的服务器，但是原来的 Nginx 配置文件比较复杂，迁移起来麻烦，而且证书自动续期也得重新配置。 在查阅资料时，我发现了 Caddy 这个轻量级的 Web 服务器，配置文件简洁明了，内置自动 HTTPS 功能，非常适合个人和小型项目使用。 为什么选择 Caddy？ Caddy 是一款基于 Go 语言编写的强大且可..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-10-14T00:37:40.000Z"}],["meta",{"property":"article:tag","content":"Nginx"}],["meta",{"property":"article:tag","content":"Caddy"}],["meta",{"property":"article:tag","content":"建站"}],["meta",{"property":"article:modified_time","content":"2025-10-14T00:37:40.000Z"}]]},"readingTime":{"minutes":3,"words":900},"git":{"createdTime":1760349193000,"updatedTime":1760402260000,"contributors":[{"name":"SuniRein","username":"SuniRein","email":"sunirein@qq.com","commits":2,"avatar":"https://avatars.githubusercontent.com/SuniRein?v=4","url":"https://github.com/SuniRein"}]},"autoDesc":true,"filePathRelative":"blog/网站建设/从Nginx到Caddy.md","headers":[],"categoryList":[{"id":"e9a3d2","sort":10000,"name":"网站建设"}]}');export{p as comp,r as data};
